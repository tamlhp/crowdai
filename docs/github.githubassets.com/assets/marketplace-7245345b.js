self.System=self.System||(()=>{const e={},t={},n=e=>e.replace(/^.\/(\w+)-[a-f0-9]{8,}.js$/,"./$1.js"),a={register(s,r){const o=n(`./${((document.currentScript||{}).src||"").split("?").shift().split("/").pop()}`),i={},l=r((e,t)=>t?i[e]=t:Object.assign(i,e),a);e[o]=Promise.all(s.map((e,t)=>a.import(n(e)).then(l.setters[t]))).then(()=>(l.execute(),i)).catch(e=>{throw e.message=`evaluating module ${o}: ${e.message}`,e}),t[o]&&(t[o](e[o]),delete t[o])},import:n=>e[n]||(e[n]=new Promise((e,a)=>{const s=setTimeout(()=>{a(new Error(`could not resolve ${n}`))},1e4);t[n]=(t=>{clearTimeout(s),e(t)})}))};return a})(),System.register(["./frameworks.js"],function(e,t){"use strict";var n,a,s,r,o,i,l,c,d,p,m,u;return{setters:[function(e){n=e.p,a=e.f,s=e.d,r=e.r,o=e.b,i=e.e,l=e.aE,c=e.ab,d=e.h,p=e.l,m=e.t,u=e.n}],execute:function(){function e(e){const t=a(e,".js-marketplace-listing-form-container");o(t,".js-marketplace-listing-error-container").classList.remove("visible")}function t(e,t){const n=a(e,".js-marketplace-listing-form-container"),s=o(n,".js-marketplace-listing-error-container");s.classList.add("visible"),o(s,".js-marketplace-listing-error").textContent=t}function f(e){const t=e.querySelector(".js-marketplace-listing-save-notice");t&&(t.classList.add("visible"),setTimeout(()=>t.classList.remove("visible"),1500))}function g(e,t){const n=a(e,".js-marketplace-listing-form-container").querySelectorAll(".js-marketplace-listing-bgcolor");for(const a of n)a.style.backgroundColor=`#${t}`}function j(e){const t=document.querySelector(".js-hero-listing-container .js-hero-listing-bgcolor");t&&(t.style.backgroundColor=`#${e}`)}function k(e,t,n){if(!(n instanceof HTMLElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:84");const s=a(n,".js-listing-characters-remaining-container"),r=o(s,".js-listing-characters-remaining"),i=String(r.getAttribute("data-suffix")),l=t-c(e);r.textContent=`${l} ${i}`,r.classList.toggle("text-red",l<=5)}function h(e){const t=e.item;t.setAttribute("data-old-index",String(e.oldIndex));const n=o(t,".js-marketplace-listing-screenshot-resequence-form",HTMLFormElement),a=n.elements.namedItem("marketplace_listing_screenshot[previousScreenshotId]");if(!(a instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:235");const s=t.previousElementSibling;s instanceof HTMLElement?a.value=d(s,"data-screenshot-id"):a.value="",p(n)}function L(e){return["FLAT_RATE","PER_UNIT"].includes(e)}function v(e){return"PER_UNIT"===e}function T(e,t){for(const n of e)n.disabled=!t}function E(e){const t=document.querySelectorAll(".js-discounted-pricing");if(t.length>0){const n=e.hasAttribute("data-discounts-enabled"),a=document.querySelectorAll(".js-original-pricing");for(const e of t)e.hidden=!n;for(const e of a)e.hidden=n}}async function b(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/order.js:9");const n=parseInt(t.value,10).toFixed(),a=d(t,"data-url"),s=new URL(a,window.location.origin),r=new URLSearchParams(s.search.slice(1));r.set("quantity",n),s.search=r.toString();const i=await u(document,s),l=o(document,".js-marketplace-order-preview");l.innerHTML="",l.appendChild(i)}n(".js-marketplace-short-description-field",function(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:96");const n=a(t,".form-group");t.validity.patternMismatch?n.classList.add("errored"):n.classList.remove("errored")}),s("click",".js-marketplace-error-dismiss",function(t){e(t.currentTarget)}),s("change",".js-marketplace-listing-light-text",function(e){const t=e.target;if(!(t instanceof HTMLSelectElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:110");!function(e){const t=document.querySelector(".js-hero-listing-name");t&&("true"===e?(t.classList.add("text-white"),t.classList.remove("text-gray-dark")):(t.classList.remove("text-white"),t.classList.add("text-gray-dark")))}(t.value)}),s("change",".js-marketplace-listing-logo-background-color",function(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:115");g(a(e.target,"form",HTMLFormElement),t.value),j(t.value)}),r(".js-marketplace-listing-form",async function(n,a){let s;e(n);try{s=await a.json()}catch(r){if(!r.response)throw r;return void t(n,r.response.json.error)}if(s.json.path){const e=window.location.pathname,t=s.json.path;if(e!==t)return void(window.location.href=t)}s.json.bgcolor&&(g(n,s.json.bgcolor),j(s.json.bgcolor)),s.json.short_description&&function(e){const t=document.querySelector(".js-hero-listing-description");t&&(t.textContent=e)}(s.json.short_description),f(n)}),r(".js-marketplace-listing-screenshot-update-form",async function(e,t){try{await t.text()}catch(r){return void function(e){const t=e.querySelector(".js-marketplace-listing-save-error");t&&(t.classList.add("visible"),setTimeout(()=>t.classList.remove("visible"),1500))}(e)}const n=o(e,".js-marketplace-listing-screenshot-caption-field",HTMLInputElement),a=o(e,".js-marketplace-listing-screenshot-caption-present"),s=o(e,".js-marketplace-listing-screenshot-caption-empty");a.textContent=n.value,n.value.trim().length<1?(a.classList.add("d-none"),s.classList.remove("d-none")):(a.classList.remove("d-none"),s.classList.add("d-none")),f(e)}),r(".js-marketplace-listing-screenshot-delete-form",async function(n,s){e(n),o(n,".js-marketplace-listing-screenshot-delete-button",HTMLButtonElement).disabled=!0;try{await s.text()}catch(r){if(r.response){try{t(n,r.response.json.error)}catch(i){throw r}finally{o(n,".js-marketplace-listing-screenshot-delete-button",HTMLButtonElement).disabled=!1}return}throw r}a(n,".js-marketplace-listing-screenshot-container").remove()}),n("textarea.js-listing-characters-remaining-field",function(e){const t=e.target;if(!(t instanceof HTMLTextAreaElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:213");const n=parseInt(t.getAttribute("data-character-limit"),10);k(t.value,n,t)}),n("input.js-listing-characters-remaining-field",function(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:219");const n=t.maxLength;k(t.value,n,t)}),s("details-menu-selected",".js-languages-menu",function(e){const t=e.currentTarget.querySelectorAll('[role="menuitemcheckbox"][aria-checked="true"]');o(document,".js-language-selection").textContent=Array.from(t).map(e=>e.textContent.trim()).sort().join(", ")},{capture:!0}),i(".js-draggable-screenshots-container",function(e){l.create(e,{animation:150,draggable:".js-draggable-screenshot",onUpdate:h})}),i(".js-listing-plan-option:checked",{constructor:HTMLInputElement,add(e){const t=e.value,n=a(e,".js-marketplace-edit-plan-editor"),s=m(n,".js-marketplace-plan-price-field-group",HTMLInputElement),r=m(n,".js-marketplace-plan-free-trial-field-group",HTMLInputElement),i=m(n,".js-marketplace-plan-unit-field-group",HTMLInputElement);!function(e){for(const t of document.querySelectorAll(".js-marketplace-plan-edit-unit"))t.hidden=!v(e);for(const t of document.querySelectorAll(".js-marketplace-plan-edit-price, .js-marketplace-plan-enable-free-trial"))t.hidden=!L(e)}(t),T(s,["FLAT_RATE","PER_UNIT"].includes(t)),T(r,L(t)),T(i,v(t)),o(n,".js-marketplace-plan-unit-name-field",HTMLInputElement).required=v(t)}}),s("click",".js-marketplace-plan-preview-toggle",function(e){const t=a(e.currentTarget,".js-marketplace-edit-plan-container"),n=o(t,".js-marketplace-plan-editor-toggle"),s=o(t,".js-marketplace-edit-plan-editor"),r=o(t,".js-marketplace-edit-plan-preview");r.classList.contains("d-none")&&(e.currentTarget.classList.add("selected"),n.classList.remove("selected"),r.classList.remove("d-none"),s.classList.add("d-none"),function(e,t){const n=o(t,".js-marketplace-plan-name"),s=o(e,".js-marketplace-plan-name-field",HTMLInputElement).value;n.textContent=s;const r=o(t,".js-marketplace-free-trial-container"),i=o(t,".js-marketplace-no-trial-container"),l=o(t,".js-marketplace-direct-billing-container");o(e,".js-marketplace-free-trial-field",HTMLInputElement).checked?(r.classList.remove("d-none"),l.classList.add("d-none"),i.classList.add("d-none")):(i.classList.remove("d-none"),r.classList.add("d-none"),l.classList.add("d-none"));const c=o(e,".js-listing-plan-option:checked",HTMLInputElement).value,d=t.querySelectorAll(".js-marketplace-plan-unit-name"),p=o(t,".js-marketplace-plan-per-unit-info");if("PER_UNIT"===c){const t=o(e,".js-marketplace-plan-unit-name-field",HTMLInputElement).value;for(const e of d)e.textContent=t,e.classList.remove("d-none");p.classList.remove("d-none")}else{for(const e of d)e.classList.add("d-none");p.classList.add("d-none")}if("FREE"===c||"DIRECT_BILLING"===c){const e=t.querySelectorAll(".js-marketplace-plan-dollars-container");for(const t of e)t.classList.add("d-none")}else{const n=o(t,".js-marketplace-plan-monthly-dollars"),s=o(e,".js-marketplace-plan-monthly-price-field",HTMLInputElement).value;n.textContent=s,a(n,".js-marketplace-plan-dollars-container").classList.remove("d-none");const r=o(t,".js-marketplace-plan-yearly-dollars"),i=o(e,".js-marketplace-plan-yearly-price-field",HTMLInputElement).value;r.textContent=i,a(r,".js-marketplace-plan-dollars-container").classList.remove("d-none")}"DIRECT_BILLING"===c&&(i.classList.add("d-none"),r.classList.add("d-none"),l.classList.remove("d-none"));const u=o(t,".js-marketplace-plan-bullets");u.innerHTML="";const f=m(e,".js-marketplace-plan-bullet-field",HTMLInputElement),g=o(t,".js-marketplace-plan-bullet-template",HTMLTemplateElement);for(const a of f){const e=a.value;if(e.trim().length<1)continue;const t=g.content.cloneNode(!0);o(t,".js-marketplace-plan-bullet").textContent=e,u.appendChild(t)}const j=o(t,".js-marketplace-plan-description"),k=o(e,".js-marketplace-plan-description-field",HTMLInputElement).value;j.textContent=k;const h=o(t,".js-marketplace-plan-for-account-type"),L=o(e,".js-plan-for-account-type").textContent.toLowerCase();h.textContent=L}(s,r))}),s("click",".js-marketplace-plan-editor-toggle",function(e){const t=a(e.currentTarget,".js-marketplace-edit-plan-container"),n=o(t,".js-marketplace-plan-preview-toggle"),s=o(t,".js-marketplace-edit-plan-editor"),r=o(t,".js-marketplace-edit-plan-preview");s.classList.contains("d-none")&&(e.currentTarget.classList.add("selected"),n.classList.remove("selected"),r.classList.add("d-none"),s.classList.remove("d-none"))}),s("change",".js-marketplace-plan-dollar-field",function(e){const t=e.currentTarget;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit-pricing.js:209");a(t,".js-marketplace-plan-dollar-field-container").classList.toggle("is-errored",!t.checkValidity())}),i(".js-selected-account [data-menu-button]",E),s("details-menu-selected",".js-accounts-menu",e=>{if(!(e instanceof CustomEvent))throw new Error("invariant: app/assets/modules/github/marketplace/listing-page.js:10");E(e.detail.relatedTarget)},{capture:!0}),i(".js-marketplace-order-quantity",function(e){e.addEventListener("input",b)}),s("change","input.js-grant-oap-checkbox",function(e){const t=e.currentTarget;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/order.js:27");const n=o(document,".js-marketplace-complete-order",HTMLButtonElement);n&&(n.disabled=!t.checked)}),s("click",".js-marketplace-complete-order",function(e){e.preventDefault();const t=e.currentTarget;if(!(t instanceof HTMLButtonElement))throw new Error("invariant: app/assets/modules/github/marketplace/order.js:34");const n=t.form,a=document.querySelector(".js-marketplace-billing-modal");"true"===t.getAttribute("data-show-billing-modal")&&a?a.setAttribute("open","true"):n&&n.submit()})}}});
//# sourceMappingURL=marketplace-7245345b.js.map
